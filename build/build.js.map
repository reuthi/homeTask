{"version":3,"sources":["webpack:///webpack/bootstrap ba1be46ae1879b327b2f","webpack:///external \"express\"","webpack:///external \"request-promise\"","webpack:///./config/config.js","webpack:///./server.js","webpack:///external \"body-parser\"","webpack:///./routes/api.router.js","webpack:///./controllers/country.controller.js","webpack:///./controllers/weather.controller.js","webpack:///external \"bluebird\"","webpack:///./controllers/filter.controller.js","webpack:///./controllers/error.controller.js"],"names":["config","weatherAppId","port","process","env","PORT","app","express","use","bodyParser","json","urlencoded","extended","listen","console","log","NODE_ENV","router","Router","continent","get","req","res","next","params","countries","getCountries","error","sortedCountries","getWeather","post","body","type","filterdCountries","filterCountries","filter","rp","method","url","then","JSON","parse","Promise","mapSeries","country","capital","weather","name","weatherForecast","main","weatherTemperature","temp","min","max","toLowerCase","errorHandler","err","status"],"mappings":"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","file":"build.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ba1be46ae1879b327b2f","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"request-promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"request-promise\"\n// module id = 1\n// module chunks = 0","export const config = { \r\n  weatherAppId:'2ad061981457f03dc56e37cea31924eb',\r\n  port: process.env.PORT || 8080\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./config/config.js","import express from 'express'\r\nimport bodyParser from 'body-parser'\r\nimport {router} from './routes/api.router'\r\nimport {config} from './config/config'\r\nimport {errorHandler} from './controllers/error.controller'\r\nconst app = express(); \r\n\r\napp.use(bodyParser.json());\r\napp.use(bodyParser.urlencoded({ extended: true }));\r\napp.use('/api/v1',router);\r\napp.use(errorHandler);\r\napp.listen(config.port,()=> console.log(`Running in ${process.env.NODE_ENV} on port ${config.port}`));\n\n\n// WEBPACK FOOTER //\n// ./server.js","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 4\n// module chunks = 0","import express from 'express'\r\nimport { getCountries } from '../controllers/country.controller'\r\nimport { getWeather } from '../controllers/weather.controller'\r\nimport { filterCountries } from '../controllers/filter.controller'\r\n\r\nexport const router = express.Router();\r\nlet continent = 'Americas'\r\n\r\nrouter.get('/countries/:continent?', async (req, res, next) => {\r\n  if (req.params.continent) continent = req.params.continent\r\n  try {\r\n    const countries = await getCountries(continent)\r\n    res.json(countries)\r\n  }\r\n  catch (error) {\r\n    next(error)\r\n  }\r\n})\r\n\r\nrouter.get('/weather', async (req, res, next) => {\r\n  try {\r\n    const countries = await getCountries(continent)\r\n    const sortedCountries =  await getWeather(countries)\r\n    res.json(sortedCountries)\r\n  }\r\n  catch (error) {\r\n    next(error)\r\n  }\r\n})\r\n\r\nrouter.post('/filter', async (req, res, next) => {\r\n  if(req.body.type) continent = req.body.type\r\n  try {\r\n    const countries = await getCountries(continent)\r\n    const sortedCountries =  await getWeather(countries)\r\n    const filterdCountries = filterCountries(req.body.filter, sortedCountries)\r\n    res.json(filterdCountries)\r\n  }\r\n  catch (error) {\r\n    next(error)\r\n  }\r\n})\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./routes/api.router.js","import rp from 'request-promise'\r\n\r\nexport const getCountries = async (continent) => {\r\n  return await rp({\r\n    method: 'GET',\r\n    url: `https://restcountries.eu/rest/v2/region/${continent}`\r\n  }).then(res=>JSON.parse(res))\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/country.controller.js","import rp from 'request-promise'\r\nimport Promise from 'bluebird'\r\nimport { config } from '../config/config'\r\n\r\nexport const getWeather = async (countries) => {\r\n  let sortedCountries = await Promise.mapSeries(countries, async country => {\r\n    if(country.capital){\r\n      return await rp({\r\n        url: `http://api.openweathermap.org/data/2.5/weather?q=${country.capital}&APPID=${config.weatherAppId}&units=metric`\r\n      }).then(weather => {\r\n        weather = JSON.parse(weather)\r\n        return {\r\n          country: country.name,\r\n          capital: country.capital,\r\n          weatherForecast: weather.weather[0].main,\r\n          weatherTemperature: weather.main.temp\r\n        }\r\n      })\r\n    }\r\n  })\r\n  return sortedCountries.filter(country=>country)\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/weather.controller.js","module.exports = require(\"bluebird\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bluebird\"\n// module id = 8\n// module chunks = 0","\r\nexport const filterCountries = (filter, countries) => {\r\n  return countries.filter(country => {\r\n    return country.weatherTemperature >= filter.temp.min && country.weatherTemperature <= filter.temp.max && country.weatherForecast.toLowerCase() === filter.weather.type.toLowerCase()\r\n  })\r\n}\n\n\n// WEBPACK FOOTER //\n// ./controllers/filter.controller.js","\r\nexport const errorHandler = (err,req,res,next)=>{\r\n  if(process.env.NODE_ENV === 'development'){\r\n    console.error(err);\r\n  }\r\n  res.status(err.status || 500).json('Something went wrong')\r\n};\n\n\n// WEBPACK FOOTER //\n// ./controllers/error.controller.js"],"sourceRoot":""}